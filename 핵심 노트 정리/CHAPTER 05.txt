[CHAPTER 05 실무에 자주 쓰이는 SQL 데이터 분석]

5-1. ERD를 활용한 데이터 마트 구성

(1) ERD(Entity-Relationship Diagram) : 데이터를 구조화하기 위한 개체-관계 모델링 기법
(2) 데이터 마트 구성 : SELECT ~ INTO ~ FROM
** 중복되는 열 이름이 있으면 테이블이 생성되지 않으므로,
   JOIN되는 테이블의 열 이름을 SELECT 구문에 작성   ex) B.prod_cd, D.price

5-2. 구매 고객 프로파일 분석

(1) 고객들의 성별, 연령, 지역 등을 활용해 구매자의 특징 및 특성을 파악
(2) 임시 테이블 : 영구적으로 테이블을 생성할 필요가 없을 때 임시로 사용하는 테이블
** 세션 임시 테이블 생성 : SELECT ~ INTO #[테이블명] FROM
   (해당 쿼리창에서만 사용되며, 창 종료 시 자동 삭제)
** 전역 임시 테이블 생성 : SELECT ~ INTO ##[테이블명] FROM
   (모든 쿼리창에서 사용되며, 모든 창 종료 시 자동 삭제)

5-3. RFM 고객세분화 분석

(1) RFM(Recency, Frequency, Monetary) : 최근성, 구매빈도, 구매금액
(2) RFM 고객세분화 분석은 고객들의 구매지표(RFM)를 활용해 고객을 세분화할 때 사용
** 고객별 RFM 세션 임시 테이블 생성
** 고객세분화 그룹 열을 추가한 세션 임시 테이블 생성
** 고객세분화별 고객 수 및 매출 비중 파악

5-4. 구매전환율 및 구매주기 분석

(1) 구매전환율 및 구매주기 분석은 고객들의 구매패턴을 파악할 때 사용
** 구매전환율 세션 임시 테이블 생성
** 구매전환율 파악
** 매장코드별로 구매주기에 필요한 세션 임시 테이블 생성
** 구매주기((최근 구매일 - 최초 구매일) / (구매횟수 -1)) 파악

5-5. 제품 및 성장률 분석

(1) 제품 및 성장률 분석은 상품들의 경쟁력을 파악할 때 사용
** 브랜드 및 모델별 2020, 2021년 구매금액 세션 임시 테이블 생성
** 브랜드 및 모델별 성장률 파악 (ROW_NUMBER()를 통해 브랜드별 모델 성장률 순위 반환)